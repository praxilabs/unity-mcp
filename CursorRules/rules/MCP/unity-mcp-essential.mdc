---
alwaysApply: true
---

# Unity MCP Essential Rules

This file contains the core rules for creating Unity MCP experiments. Always read node-specific rule files before implementation.

## ğŸš¨ **MANDATORY NODE IMPLEMENTATION RULE** âš ï¸ **PRIMARY ENTRY POINT**

**CRITICAL**: Before creating ANY node in a graph, you MUST:

1. **Navigate to the specific node rule file** using the category â†’ node reference chain
2. **Read the complete node documentation** including patterns, mistakes, and best practices
3. **Understand the node's specific behavior** (e.g., ClickStep is a PAUSE node, AttachStep only attaches, etc.)
4. **Follow the established patterns** exactly as documented
5. **Only THEN implement** the node with proper connections and next steps

**VIOLATION**: Creating nodes without reading their specific rule files is a critical failure.

**Example**: For "Click on bottle to open" â†’ Navigate to ClickNodes â†’ ClickStep â†’ Read ClickStep.mdc â†’ Understand it's a PAUSE node â†’ Implement: ClickStep â†’ AnimationStep

---

## ğŸ§­ **NAVIGATION GUIDE** â­ **HOW TO FIND AND USE EXISTING NODES**

### **ğŸš€ QUICK START: Finding the Right Node Type**

**Step 1: Identify Your Need**
- What do you want to accomplish in your experiment?
- What type of interaction or operation do you need?

**FunctionCallStep Rule**: For any experiment step that doesn't have a dedicated node, use FunctionCallStep directly. Break complex operations into logical steps: use existing nodes (AttachStep, ClickStep) for what they handle, then FunctionCallStep for custom logic.

**Step 2: Navigate to the Right Category**
Use the **Quick Decision Tree** below to find your category, then follow the reference links.

**Step 3: Read the Category File**
Each category file contains:
- **Available node types** in that category
- **Specific patterns** and best practices
- **Common mistakes** to avoid
- **Connection requirements** and validation rules


**Step 4: Navigate to Specific Node**
Within each category file, you'll find references to individual node files with detailed implementation guides.

---

## ğŸ¯ **QUICK DECISION TREE** â­ **FIND YOUR CATEGORY**

**Need to show/hide objects or enable/disable colliders?**
â†’ **Tools** category â†’ ToolNodes.mdc

**Need user interaction in any order or parallel execution?**
â†’ **Control Flow** category â†’ ControlFlowNodes.mdc

**Need to attach/detach objects or equipment assembly?**
â†’ **Attach-Detach** category â†’ AttachDetachNodes.mdc

**Need clicking, selection, or interactive manipulation?**
â†’ **Click** category â†’ ClickNodes.mdc

**Need camera positioning, focus, or view management?**
â†’ **Camera** category â†’ CameraNodes.mdc

**Need to call methods on GameObjects or system functions?**
â†’ **Function Call** category â†’ FunctionCallNodes.mdc

**Need loops, iterations, or repeated actions?**
â†’ **Loops** category â†’ LoopNodes.mdc

**Need UI messages, hints, timers, or user interface?**
â†’ **UI** category â†’ UINodes.mdc

**Need delays, subgraphs, or utility operations?**
â†’ **Utility** category â†’ UtilityNodes.mdc

**Need event-driven interactions or reactive programming?**
â†’ **New Events** category â†’ NewEventsNodes.mdc

**Need data tables, records, or stage management?**
â†’ **Table** category â†’ TableNodes.mdc

**Need progress tracking or stage navigation?**
â†’ **Progress Map** category â†’ ProgressMapNodes.mdc

**Need animations, subgraphs, or miscellaneous operations?**
â†’ **Misc** category â†’ MiscNodes.mdc


## ğŸ” **NAVIGATION WORKFLOW**

**Standard Process**:
1. **Identify Need** â†’ Use decision tree to find category
2. **Read Category File** â†’ Understand patterns and requirements
3. **Find Specific Node** â†’ Locate exact node type needed
4. **Read Node Details** â†’ Follow implementation patterns
5. **Apply Pattern** â†’ Use established best practices

**Example Workflow**:
- Need: "Click on bottle to open"
- Category: Click category
- Node: ClickStep
- Pattern: ClickStep (pause) â†’ AnimationStep (open animation)
- Implementation: Create ClickStep node, then AnimationStep node, connect them

**Reference Chain**:
```
Category File â†’ Specific Node File â†’ Implementation Pattern â†’ Validation Rules
```

---

## ğŸ¯ **MULTI-STAGE HANDLING RULE**

**Multi-Stage Principle**:
When a user requests multiple stages, each stage is a separate StepsGraph with no direct connections between them.

**Stage Rules**:
- Each stage = Separate StepsGraph asset in `Assets/Testing/Graphs/`
- No cross-stage node connections within the same graph
- Stage transitions only via GoToStageStep node
- Each graph handles one stage completely

**Architecture**:
```bash
Assets/Testing/Graphs/
â”œâ”€â”€ ChemistryLab_VitaminCAnalysis_Stage1_StepGraph.asset
â”œâ”€â”€ ChemistryLab_VitaminCAnalysis_Stage2_StepGraph.asset
â””â”€â”€ ChemistryLab_VitaminCAnalysis_Stage3_StepGraph.asset
```

**Transition Pattern**:
```bash
Stage1_Graph: FinalNode â†’ GoToStageStep(Stage2) â†’ End
Stage2_Graph: Start â†’ Stage2Content â†’ End
```

---

## ğŸ­ **SCENARIO PATTERN RULE**

**Scenario Selection Pattern**:
All scenario-based experiments follow this pattern for user choice handling:

```bash
1. GameObjectSetActiveStep(ChoicesCanvasUI) â†’ Enable choice UI
2. ClickUIStep(ConfirmScenarioButton) â†’ User clicks to confirm
3. FunctionCallStep(ChoicesUIScript.isScenarioA) â†’ Check user choice
4. IfStatementStep â†’ Route to correct scenario
   â”œâ”€â”€ True: Execute Scenario 1
   â””â”€â”€ False: Execute Scenario 2
```

**Implementation**:
```bash
GameObjectSetActiveStep(ChoicesCanvasUI) 
    â†“
ClickUIStep(ConfirmScenarioButton)
    â†“
FunctionCallStep(ChoicesUIScript.isScenarioA)
    â†“
IfStatementStep
    â”œâ”€â”€ True â†’ SubGraphStep(Scenario1_Graph)
    â””â”€â”€ False â†’ SubGraphStep(Scenario2_Graph)
```

---

## ğŸ“ **GRAPH NAMING RULE**

**Create graphs with descriptive, meaningful names that explain the graph's purpose.**

**Naming Convention**:
```
[ExperimentType]_[SpecificPurpose]_[GraphType]
```

**Examples**:
- `PhysicsLab_Mechanics_StepGraph`
- `ChemistryLab_Titration_StepGraph`
- `BiologyLab_Microscopy_StepGraph`
- `InteractiveLab_EquipmentSetup_StepGraph`

**Guidelines**:
1. Be specific: Include exact experiment type and purpose
2. Include phase number/name if multi-phase
3. Always include `StepGraph` suffix
4. Use underscores to separate words
5. Avoid generic names like "NewStepsGraph", "Graph1", "Experiment", "Test"

---

## ğŸ¯ **SCRIPTABLE OBJECT CREATION RULE**

**Standard Protocol**:
```bash
# 1. Create ExperimentData
mcp_unityMCP_create_scriptable_object --scriptable_object_type "ExperimentData" --asset_name "[ExperimentType]_[Purpose]_ExperimentData" --folder "Assets/Testing/"

# 2. Create ItemsRegistry
mcp_unityMCP_create_scriptable_object --scriptable_object_type "ExperimentItemsRegistry" --asset_name "[ExperimentType]_[Purpose]_ItemsRegistry" --folder "Assets/Testing/"

# 3. Create StepsGraph
mcp_unityMCP_create_scriptable_object --scriptable_object_type "StepsGraph" --asset_name "[ExperimentType]_[Purpose]_StepGraph" --folder "Assets/Testing/Graphs/"
```

---

## ğŸ”— **ADDITIONAL REFERENCES**

- **Graph Validation Rules** - Post-creation validation
- **Graph Connection Rules** - Critical connection requirements
- **Positioning Strategy** - Node positioning and staging rules
- **MCP Tools Reference** - Complete tool reference
